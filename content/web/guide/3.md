/*
Title : 3.保存数据
Sort : 3
Tmpl : page-guide
*/

## 3.保存数据

#### 保存数据的方式
|method |description | 
| --- |---- | 
| set() | 写入和替换当前路径的数据 |
| update() |修改部分子节点的数据 |
| push() | 在当前节点下新增一个数据，数据的key随机生成 |

#### 用 set() 写数据
set 是 Wilddog 最基本的写数据操作。set() 设置当前节点的值，如果当前节点已经存在值，set 会将旧值替换成新值。为了理解set的工作原理，我们创建一个简单博客app，这个博客的app储存在这里
```js

var ref = new Wilddog("https://<appId>.wilddogio.com/web/saving-data/fireblog");

```
我们储存一些数据到Wilddog，我们用一个唯一的username 保存用户。我们同时储存他们的全称和生日。因为每一个用户都有一个唯一的 username，所以我们使用set 而不是push
首先，我们创建一个引用，然后我们用set储存数据，set可以传入 `string,number,boolean,object` 类型:
```js

var usersRef = ref.child("users");

usersRef.set({

  alanisawesome: {

    date_of_birth: "June 23, 1912",

    full_name: "Alan Turing"

  },

  gracehop: {

    date_of_birth: "December 9, 1906",

    full_name: "Grace Hopper"

  }

});

```

这时，数据被嵌套保存到了相应的位置上，
完成上面的过程，你还可以直接这样做:

```js

usersRef.child("alanisawesome").set({

  date_of_birth: "June 23, 1912",

  full_name: "Alan Turing"

});

usersRef.child("gracehop").set({

  date_of_birth: "December 9, 1906",

  full_name: "Grace Hopper"

});

```
这两种方式的区别是，如果 /user 下面原来有数据的时候，第一种方式会把数据全部覆盖掉，而第二种方式只会覆盖 `alanisawesome` 和`gracehop` 两个子节点.



#### 更新已经存在的数据

如果你想同时更新多个子节点，而不覆盖其他的子节点，你可以使用 update() 方法:


```js

var hopperRef = usersRef.child("gracehop");

hopperRef.update({

  "nickname": "Amazing Grace"

});

```

这样会更新 Grace的数据，更新她的 `nickname` 。如果我们用 `set` 而不是 `update` ，`date_of_birth` 和 `full_name` 都会被删除



#### 保存一个列表
当多个用户同时试图在一个节点下新增一个子节点的时候，这时，数据就会被重写，覆盖。
为了解决这个问题，Wilddog push()采用了生成唯一ID 作为key的方式。通过这种方式，多个用户同时在一个节点下面push 数据，他们的key一定是不同的。这个key是通过一个基于时间戳和随机的算法生成的。wilddog采用了足够多的位数保证唯一性。

用户可以用post 向 blog app 中写新内容


```js

var postsRef = ref.child("posts");

  postsRef.push({

    author: "gracehop",

    title: "Announcing COBOL, a New Programming Language"

  });

  postsRef.push({

    author: "alanisawesome",

    title: "The Turing Machine"

  });

```

产生的数据有一个唯一ID:
```json

{

  "posts": {

    "-JRHTHaIs-jNPLXO": {

      "author": "gracehop",

      "title": "Announcing COBOL, a New Programming Language"

    },

    "-JRHTHaKuITFIhnj": {

      "author": "alanisawesome",

      "title": "The Turing Machine"

    }
  }
}

```

>**获取唯一ID**
>调用push 会返回一个引用，这个引用指向新增数据所在的节点。你可以通过调用 `key()` 来获取这个唯一ID
>
> ```js

> // Generate a reference to a new location and add some data using push()

>var newPostRef = postsRef.push({

>  author: "gracehop",

>  title: "Announcing COBOL, a New Programming Language"

>});
>
>// Get the unique ID generated by push()

>var postID = newPostRef.key();

> ```


